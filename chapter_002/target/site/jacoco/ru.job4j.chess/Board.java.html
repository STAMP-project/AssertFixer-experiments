<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Board.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">chapter_002</a> &gt; <a href="index.source.html" class="el_package">ru.job4j.chess</a> &gt; <span class="el_source">Board.java</span></div><h1>Board.java</h1><pre class="source lang-java linenums">package ru.job4j.chess;

import ru.job4j.chess.exceptions.FigureNotFoundException;
import ru.job4j.chess.exceptions.ImpossibleMoveException;
import ru.job4j.chess.exceptions.OccupiedWayException;
import ru.job4j.chess.figures.*;

public class Board {

    private static final int BOARD_SIZE = 8;

    private static final int INITIAL_FIGURES_COUNT = 32;

<span class="nc" id="L14">    private int figureInd = 0;</span>

    private Figure[] figures;

<span class="nc" id="L18">    Board() {</span>
<span class="nc" id="L19">        this.figures = new Figure[INITIAL_FIGURES_COUNT];</span>
<span class="nc" id="L20">    }</span>

    /**
     * Начальная расстановка Пешек.
     */
    private void setPawns() {
<span class="nc" id="L26">        int whitePawsRow = 6; //начальная позиция белых пешек(2-ой ряд)</span>
<span class="nc" id="L27">        int blackPawRow = 1; //начальная позиция черных пешек(7-ой ряд)</span>
<span class="nc bnc" id="L28" title="All 2 branches missed.">        for (int i = 0; i &lt; BOARD_SIZE; i++) {</span>
<span class="nc" id="L29">            figures[figureInd++] = new Pawn(new Cell(whitePawsRow, i));</span>
<span class="nc" id="L30">            figures[figureInd++] = new Pawn(new Cell(blackPawRow, i));</span>
        }
<span class="nc" id="L32">    }</span>

    /**
     * Начальная расстановка Слонов.
     */
    private void setBishops() {
<span class="nc" id="L38">        int whiteBishopsRow = 7;</span>
<span class="nc" id="L39">        int blackBishopsRow = 0;</span>
<span class="nc" id="L40">        int fBishopsCol = 2;</span>
<span class="nc" id="L41">        int sBishopsCol = 5;</span>

<span class="nc" id="L43">        figures[figureInd++] = new Bishop(new Cell(whiteBishopsRow, fBishopsCol));</span>
<span class="nc" id="L44">        figures[figureInd++] = new Bishop(new Cell(whiteBishopsRow, sBishopsCol));</span>
<span class="nc" id="L45">        figures[figureInd++] = new Bishop(new Cell(blackBishopsRow, fBishopsCol));</span>
<span class="nc" id="L46">        figures[figureInd++] = new Bishop(new Cell(blackBishopsRow, sBishopsCol));</span>
<span class="nc" id="L47">    }</span>

    /**
     * Начальная расстановка Королей.
     */
    private void setKings() {
<span class="nc" id="L53">        int whiteKingRow = 7;</span>
<span class="nc" id="L54">        int blackKingRow = 0;</span>
<span class="nc" id="L55">        int kingCol = 3;</span>

<span class="nc" id="L57">        figures[figureInd++] = new King(new Cell(whiteKingRow, kingCol));</span>
<span class="nc" id="L58">        figures[figureInd++] = new King(new Cell(blackKingRow, kingCol));</span>
<span class="nc" id="L59">    }</span>

    /**
     * Начальная расстановка Ферзей.
     */
    private void setQueens() {
<span class="nc" id="L65">        int whiteQueenRow = 7;</span>
<span class="nc" id="L66">        int blackQueenRow = 0;</span>
<span class="nc" id="L67">        int queenCol = 4;</span>

<span class="nc" id="L69">        figures[figureInd++] = new King(new Cell(whiteQueenRow, queenCol));</span>
<span class="nc" id="L70">        figures[figureInd++] = new King(new Cell(blackQueenRow, queenCol));</span>
<span class="nc" id="L71">    }</span>

    /**
     * Начальная расстановка Ладей.
     */
    private void setRooks() {
<span class="nc" id="L77">        int whiteRooksRow = 7;</span>
<span class="nc" id="L78">        int blackRooksRow = 0;</span>
<span class="nc" id="L79">        int fRookCol = 0;</span>
<span class="nc" id="L80">        int sRookCol = 7;</span>

<span class="nc" id="L82">        figures[figureInd++] = new Rook(new Cell(whiteRooksRow, fRookCol));</span>
<span class="nc" id="L83">        figures[figureInd++] = new Rook(new Cell(whiteRooksRow, sRookCol));</span>
<span class="nc" id="L84">        figures[figureInd++] = new Rook(new Cell(blackRooksRow, fRookCol));</span>
<span class="nc" id="L85">        figures[figureInd++] = new Rook(new Cell(blackRooksRow, sRookCol));</span>
<span class="nc" id="L86">    }</span>

    /**
     * Начаальная расстановка Коней.
     */
    private void setKnights() {
<span class="nc" id="L92">        int whiteKnightsRow = 7;</span>
<span class="nc" id="L93">        int blackKnightRow = 0;</span>
<span class="nc" id="L94">        int fKnightCol = 1;</span>
<span class="nc" id="L95">        int sKnightCol = 6;</span>

<span class="nc" id="L97">        figures[figureInd++] = new Knight(new Cell(whiteKnightsRow, fKnightCol));</span>
<span class="nc" id="L98">        figures[figureInd++] = new Knight(new Cell(whiteKnightsRow, sKnightCol));</span>
<span class="nc" id="L99">        figures[figureInd++] = new Knight(new Cell(blackKnightRow, fKnightCol));</span>
<span class="nc" id="L100">        figures[figureInd++] = new Knight(new Cell(blackKnightRow, sKnightCol));</span>
<span class="nc" id="L101">    }</span>

    /**
     * Начальная расстановка фигур.
     */
    public void setFigures() {
<span class="nc" id="L107">        setBishops();</span>
<span class="nc" id="L108">        setKings();</span>
<span class="nc" id="L109">        setKnights();</span>
<span class="nc" id="L110">        setPawns();</span>
<span class="nc" id="L111">        setQueens();</span>
<span class="nc" id="L112">        setRooks();</span>
<span class="nc" id="L113">    }</span>

    public boolean move(Cell source, Cell dest) throws ImpossibleMoveException, OccupiedWayException, FigureNotFoundException {
<span class="nc" id="L116">        boolean result = false;</span>
<span class="nc" id="L117">        Figure sourceFigure = null;</span>
<span class="nc" id="L118">        Figure destFigure = null;</span>

<span class="nc bnc" id="L120" title="All 2 branches missed.">        for (Figure figure : figures) {</span>
<span class="nc bnc" id="L121" title="All 2 branches missed.">            if (figure.position.equals(source)) {</span>
<span class="nc" id="L122">                sourceFigure = figure;</span>
            }
<span class="nc bnc" id="L124" title="All 2 branches missed.">            if (figure.position.equals(dest)) {</span>
<span class="nc" id="L125">                destFigure = figure;</span>
            }
        }

<span class="nc" id="L129">        Cell[] way = sourceFigure.way(dest);</span>

<span class="nc bnc" id="L131" title="All 2 branches missed.">        if (sourceFigure == null) {</span>
<span class="nc" id="L132">            throw new FigureNotFoundException(&quot;Фигура не найдена.&quot;);</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">        } else if (destFigure != null) {</span>
<span class="nc" id="L134">            throw new OccupiedWayException(&quot;Клетка занята.&quot;);</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">        } else if (way.length == 0) {</span>
<span class="nc" id="L136">            throw new ImpossibleMoveException(&quot;Ход невозможен.&quot;);</span>
<span class="nc bnc" id="L137" title="All 2 branches missed.">        } else if (way.length != 0) {</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">            for (Cell cell : way) {</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">                for (Figure figure : figures) {</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">                    if (cell.equals(figure.position)) {</span>
<span class="nc" id="L141">                        throw new ImpossibleMoveException(&quot;Ход невозможен.(Фигура на пути.)&quot;);</span>
                    }
                }
            }
<span class="nc" id="L145">            Figure clonedFigure = sourceFigure.clone(dest);</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">            for (int i = 0; i &lt; figures.length; i++) {</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">                if (figures[i].equals(sourceFigure)) {</span>
<span class="nc" id="L148">                    figures[i] = clonedFigure;</span>
                }
            }
<span class="nc" id="L151">            result = true;</span>
            }
<span class="nc" id="L153">        return result;</span>
        }
    }
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>